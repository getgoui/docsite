{"version":3,"names":["goTooltipCss","GoTooltip","this","debouncedDetermineMouseOut","debounce","determineMouseOut","componentWillLoad","el","id","uniqueId","triggerEl","document","querySelector","triggerId","componentDidLoad","setAttribute","addEventListener","show","e","hide","arrowEl","initialiseTooltip","cleanUpAutoUpdate","autoUpdate","animationFrame","key","tooltipEl","middleware","offset","flip","shift","arrow","push","element","inline","computePosition","strategy","placement","then","x","y","middlewareData","Object","assign","style","left","top","arrowX","arrowY","staticSide","right","bottom","split","isActive","getBoundingClientRect","triggerLeft","triggerTop","triggerRight","triggerBottom","isOutside","isOutsideTrigger","disconnectedCallback","render","h","Host","role","class"],"sources":["src/components/go-tooltip/go-tooltip.scss?tag=go-tooltip","src/components/go-tooltip/go-tooltip.tsx"],"sourcesContent":["go-tooltip {\r\n  /**\r\n    @prop --tooltip-bg-color:\r\n      Background color of the tooltip.\r\n      - default: var(--go-color-primary-800)\r\n  */\r\n  --tooltip-bg-color: var(--go-color-primary-800);\r\n\r\n  /**\r\n    @prop --tooltip-fg-color:\r\n      Text color of the tooltip.\r\n      - default: var(--go-color-lightest)\r\n  */\r\n  --tooltip-fg-color: var(--go-color-lightest);\r\n\r\n  /**\r\n    @prop --tooltip-padding:\r\n      Padding around tooltip\r\n      - default: 0.5rem\r\n  */\r\n  --tooltip-padding: 0.5rem;\r\n\r\n  /**\r\n    @prop --tooltip-radius:\r\n      Border radius of tooltip\r\n      - default: var(--radius-2)\r\n  */\r\n  --tooltip-radius: var(--radius-2);\r\n\r\n  @include transition(opacity, visibility);\r\n\r\n  position: fixed;\r\n  display: block;\r\n  visibility: hidden;\r\n  opacity: 0;\r\n  background-color: var(--tooltip-bg-color);\r\n  color: var(--tooltip-fg-color);\r\n  padding: var(--tooltip-padding);\r\n  border-radius: var(--tooltip-radius);\r\n  box-shadow: var(--shadow-1);\r\n  pointer-events: none;\r\n  font-size: var(--go-size-0);\r\n  z-index: var(--layer-important);\r\n\r\n  &.is-active {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    pointer-events: inherit;\r\n  }\r\n\r\n  .tooltip-tail {\r\n    position: absolute;\r\n    background: var(--tooltip-bg-color);\r\n    width: 6px;\r\n    height: 6px;\r\n    transform: rotate(45deg);\r\n  }\r\n}\r\n","import { Component, Host, h, Element, Prop, State, Method } from '@stencil/core';\r\nimport { uniqueId, debounce } from 'lodash-es';\r\nimport { computePosition, flip, shift, arrow, offset, autoUpdate, inline } from '@floating-ui/dom';\r\n\r\n@Component({\r\n  tag: 'go-tooltip',\r\n  styleUrl: 'go-tooltip.scss',\r\n  shadow: false,\r\n})\r\nexport class GoTooltip {\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Query selector string for the trigger element\r\n   */\r\n  @Prop() triggerId: string;\r\n\r\n  /**\r\n   * Add arrow to the tooltip\r\n   */\r\n  @Prop() arrow: boolean = false;\r\n\r\n  /**\r\n   * Improve positioning for inline trigger elements that span over multiple lines.\r\n   * Reference: https://floating-ui.com/docs/inline\r\n   */\r\n  @Prop() inline: boolean = false;\r\n\r\n  /**\r\n   * placement of tooltip relative to the trigger element\r\n   */\r\n  @Prop() placement: 'top' | 'bottom' | 'left' | 'right' = 'top';\r\n\r\n  private triggerEl: HTMLElement;\r\n  private arrowEl: HTMLElement;\r\n\r\n  componentWillLoad() {\r\n    // if id attribute is not provided, generate a unique id for the tooltip\r\n    if (!this.el.id) {\r\n      this.el.id = uniqueId('go-tooltip-');\r\n    }\r\n    this.triggerEl = document.querySelector(`#${this.triggerId}`) as HTMLElement;\r\n  }\r\n\r\n  private cleanUpAutoUpdate;\r\n\r\n  componentDidLoad() {\r\n    if (!this.triggerEl) {\r\n      return;\r\n    }\r\n\r\n    this.triggerEl.setAttribute('aria-describedby', this.el.id);\r\n    // add event handlers to triggerEl\r\n    this.triggerEl.addEventListener('mouseenter', () => this.show());\r\n    document.addEventListener('mousemove', (e) => this.debouncedDetermineMouseOut(e));\r\n    this.triggerEl.addEventListener('focusin', () => this.show());\r\n    this.triggerEl.addEventListener('focusout', () => this.hide());\r\n\r\n    this.arrowEl = this.el.querySelector('.tooltip-tail') as HTMLElement;\r\n    this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl);\r\n    // keep watching for changes to the tooltip position\r\n    this.cleanUpAutoUpdate = autoUpdate(\r\n      this.triggerEl,\r\n      this.el,\r\n      debounce(() => this.initialiseTooltip(this.triggerEl, this.el, this.arrowEl), 300),\r\n      { animationFrame: true },\r\n    );\r\n\r\n    // press esc to hide tooltip\r\n    document.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Escape') {\r\n        this.hide();\r\n      }\r\n    });\r\n  }\r\n\r\n  initialiseTooltip(triggerEl, tooltipEl, arrowEl) {\r\n    let middleware = [offset(8), flip(), shift()];\r\n    if (this.arrow) {\r\n      middleware.push(arrow({ element: arrowEl }));\r\n    }\r\n\r\n    if (this.inline) {\r\n      middleware.push(inline());\r\n    }\r\n    computePosition(triggerEl, tooltipEl, {\r\n      strategy: 'fixed',\r\n      placement: this.placement,\r\n      middleware,\r\n    }).then(({ x, y, placement, middlewareData }) => {\r\n      Object.assign(this.el.style, {\r\n        left: `${x}px`,\r\n        top: `${y}px`,\r\n      });\r\n      if (this.arrow) {\r\n        // Accessing the data\r\n        const { x: arrowX, y: arrowY } = middlewareData.arrow;\r\n\r\n        const staticSide = {\r\n          top: 'bottom',\r\n          right: 'left',\r\n          bottom: 'top',\r\n          left: 'right',\r\n        }[placement.split('-')[0]];\r\n\r\n        Object.assign(arrowEl.style, {\r\n          left: arrowX != null ? `${arrowX}px` : '',\r\n          top: arrowY != null ? `${arrowY}px` : '',\r\n          right: '',\r\n          bottom: '',\r\n          [staticSide]: '-3px',\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  @State() isActive: boolean = false;\r\n\r\n  /**\r\n   * show tooltip\r\n   */\r\n  @Method()\r\n  async show() {\r\n    this.isActive = true;\r\n  }\r\n\r\n  /**\r\n   * hide tooltip\r\n   */\r\n  @Method()\r\n  async hide() {\r\n    this.isActive = false;\r\n  }\r\n  debouncedDetermineMouseOut = debounce(this.determineMouseOut, 150);\r\n  determineMouseOut(e: MouseEvent) {\r\n    if (!this.isActive) {\r\n      return;\r\n    }\r\n    // check if mouse is outside of the tooltip and the trigger element\r\n    const { x, y } = e;\r\n    const { left, top, right, bottom } = this.el.getBoundingClientRect();\r\n    const { left: triggerLeft, top: triggerTop, right: triggerRight, bottom: triggerBottom } = this.triggerEl.getBoundingClientRect();\r\n    const isOutside = x < left || x > right || y < top || y > bottom;\r\n    const isOutsideTrigger = x < triggerLeft || x > triggerRight || y < triggerTop || y > triggerBottom;\r\n    if (isOutside && isOutsideTrigger) {\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.cleanUpAutoUpdate && this.cleanUpAutoUpdate();\r\n  }\r\n\r\n  render() {\r\n    const { isActive, arrow } = this;\r\n\r\n    return (\r\n      <Host role=\"tooltip\" class={{ 'is-active': isActive }} aria-hidden={isActive ? 'false' : 'true'}>\r\n        <slot></slot>\r\n        {arrow ? <div class=\"tooltip-tail\"></div> : null}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}