import{r as e,c as t,h as i,g as o}from"./p-797021b3.js";import{i as s,b as r,l as n,f as d}from"./p-c049857b.js";import"./p-3d035636.js";import{p as a}from"./p-66f1b45b.js";import{u as l}from"./p-fa247fce.js";import"./p-465a6716.js";var c;(function(e){e["Backspace"]="Backspace";e["Clear"]="Clear";e["Down"]="ArrowDown";e["End"]="End";e["Enter"]="Enter";e["Escape"]="Escape";e["Home"]="Home";e["Left"]="ArrowLeft";e["PageDown"]="PageDown";e["PageUp"]="PageUp";e["Right"]="ArrowRight";e["Space"]=" ";e["Tab"]="Tab";e["Up"]="ArrowUp"})(c||(c={}));var h;(function(e){e[e["Close"]=0]="Close";e[e["CloseSelect"]=1]="CloseSelect";e[e["First"]=2]="First";e[e["Last"]=3]="Last";e[e["Next"]=4]="Next";e[e["Open"]=5]="Open";e[e["PageDown"]=6]="PageDown";e[e["PageUp"]=7]="PageUp";e[e["Previous"]=8]="Previous";e[e["Select"]=9]="Select";e[e["Space"]=10]="Space";e[e["Type"]=11]="Type"})(h||(h={}));var u;(function(e){e[e["Close"]=0]="Close";e[e["First"]=1]="First";e[e["Last"]=2]="Last";e[e["Next"]=3]="Next";e[e["Open"]=4]="Open";e[e["Previous"]=5]="Previous";e[e["Select"]=6]="Select";e[e["UpLevel"]=7]="UpLevel"})(u||(u={}));function f(e=[],t,i=[]){let o=t.toLowerCase().trim();return e.filter((e=>{const t=e.label.toLowerCase().indexOf(o)===0;return t&&i.indexOf(e)<0}))}function p(e,t){const{key:i,altKey:o,ctrlKey:s,metaKey:r}=e;const n=["ArrowDown","ArrowUp","Enter"," ","Home","End"];if(!t&&n.includes(i)){return h.Open}if(i===c.Backspace||i===c.Clear||i.length===1&&i!==" "&&!o&&!s&&!r){return h.Type}if(t){if(i===c.Down&&!o||i===c.Right){return h.Next}else if(i===c.Up&&o){return h.CloseSelect}else if(i===c.Up||i===c.Left){return h.Previous}else if(i===c.Home){return h.First}else if(i===c.End){return h.Last}else if(i===c.PageUp){return h.PageUp}else if(i===c.PageDown){return h.PageDown}else if(i===c.Escape){return h.Close}else if(i===c.Enter){return h.CloseSelect}else if(i===c.Space){return h.Space}}}function g(e,t,i=0){const o=[...e.slice(i),...e.slice(0,i)];const s=f(o,t)[0];const r=e=>e.every((t=>t===e[0]));if(s){return e.indexOf(s)}else if(r(t.split(""))){const i=f(o,t[0]);return e.indexOf(i[0])}else{return-1}}function m(e,t,i){switch(i){case h.First:return 0;case h.Last:return t;case h.Previous:return Math.max(0,e-1);case h.Next:return Math.min(t,e+1);default:return e}}function v(e){return e&&e.clientHeight<e.scrollHeight}function b(e,t){const{offsetHeight:i,offsetTop:o}=e;const{offsetHeight:s,scrollTop:r}=t;const n=o<r;const d=o+i>r+s;if(n){t.scrollTo(0,o)}else if(d){t.scrollTo(0,o-s+i)}}const w=e=>{try{console.log("parseSelectOptions",{options:e});if(typeof e==="string"&&!e.startsWith("[")){e=e.split(",")}const t=a(e);if(t){return t.map((e=>typeof e==="string"?{value:e,label:e}:e))}}catch(t){console.error(`Couldn't parse options: `,e,{e:t})}};const x='go-select{--dd-item-padding-y:0.5rem;--dd-item-padding-x:1rem;--dd-item-padding:var(--dd-item-padding-y) var(--dd-item-padding-x);--dd-item-radius:var(--radius-1);--dd-item-bg:var(--dropdown-bg-color);--dd-item-bg-hover:var(--go-color-neutral-200);--dd-item-bg-selected:var(--go-color-neutral-200);--dd-item-fg:var(--go-color-neutral-900);--dd-item-fg-hover:var(--go-color-darkest);--dd-item-fg-selected:var(--go-color-darkest);--dd-item-bg-disabled:transparent;--dd-item-fg-disabled:var(--go-color-neutral-600);--dd-item-width:100%;--dd-item-line-height:1.5em;--dropdown-width:100%}go-select .combo{width:100%;position:relative}go-select .control-icon{z-index:1}go-select .control{cursor:pointer;display:flex;justify-content:space-between;align-items:center}go-select .control .arrow{height:1.5em;transition:transform var(--go-duration-normal) var(--go-timing-function)}@media (prefers-reduced-motion: reduce){go-select .control .arrow{transition-duration:0s}}go-select .control .arrow.open{transform:rotate(180deg)}go-select go-dropdown{max-height:20rem;overflow:auto;z-index:9}go-select .combo-option{background:none;border:none;text-decoration:none;cursor:pointer;display:block;padding:var(--dd-item-padding);border-radius:var(--dd-item-radius);background:var(--dd-item-bg);color:var(--dd-item-fg);width:var(--dd-item-width);line-height:var(--dd-item-line-height);min-height:calc(2 * var(--dd-item-padding-y) + var(--dd-item-line-height));text-align:start}go-select .combo-option:hover{background:var(--dd-item-bg-hover);color:var(--dd-item-fg-hover)}go-select .combo-option:focus-visible{position:relative;z-index:1;outline:var(--go-focus-outline-width, 2px) solid var(--go-focus-outline-color, #000)}go-select .combo-option[aria-selected]{background:var(--dd-item-bg-selected);color:var(--dd-item-fg-selected);padding-right:2rem;position:relative}go-select .combo-option[aria-selected]::after{border-bottom:0.125rem solid currentColor;border-right:0.125rem solid currentColor;content:"";height:1rem;position:absolute;right:1rem;top:50%;transform:translate(0, -50%) rotate(45deg);width:0.5rem}go-select[disabled] .combo-option{background:var(--dd-item-bg-disabled);color:var(--dd-item-fg-disabled)}';const y=class{constructor(i){e(this,i);this.goChange=t(this,"gochange",7);this.hasNamedSlot={};this.prefixer="go-select-";this.controlId=l(this.prefixer);this.ignoreBlur=false;this.name=undefined;this.label=undefined;this.labelId=undefined;this.suffixId=undefined;this.hintId=undefined;this.errorId=undefined;this.disabled=undefined;this.hint=undefined;this.error=undefined;this.readonly=undefined;this.value=undefined;this.options=undefined;this.parsedOptions=[];this.attrs=undefined;this.activeIndex=-1;this.open=false;this.searchString=undefined;this.searchTimeout=undefined;this.selectedIndex=undefined;this.selectedLabel="";this.dropdownWidth="auto"}async componentWillLoad(){this.loadOptions();this.attrs=s(this,["options"]);this.hasNamedSlot=r(this.el);if(this.value){this.loadValue()}}loadOptions(){this.parsedOptions=w(this.options)}loadValue(){this.activeIndex=this.parsedOptions.findIndex((e=>e.value===this.value));this.selectOption(this.activeIndex)}handleDomOnOpen(e){if(e){this.listboxRef.open();if(this.inputRef){this.dropdownWidth=`${this.inputRef.offsetWidth}px`}if(v(this.listboxRef)&&this.activeOptionRef){b(this.activeOptionRef,this.listboxRef)}}else{this.listboxRef.close()}}render(){var e;const{parsedOptions:t,activeIndex:o,controlId:s,open:r=false,dropdownWidth:a,value:l,readonly:c,disabled:h,name:u,attrs:f}=this;const p=n(this);const g=r?`${s}-${o}`:"";const m=Object.assign({id:s,name:u,value:l},f);return[i("input",{type:"hidden",name:u,value:l}),i("go-field",Object.assign({},p),d.map((e=>{if(this.hasNamedSlot[e]){return i("template",{slot:e},i("slot",{name:e}))}})),i("div",{class:"combo"},i("div",Object.assign({},m,{role:"combobox","aria-activedescendant":g,"aria-autocomplete":"none","aria-haspopup":"listbox","aria-expanded":`${r}`,"aria-labelledby":`${s} ${s}-value`,"aria-controls":`${s}-listbox`,"aria-disabled":h?"true":undefined,"aria-readonly":c?"true":undefined,class:"control",id:`${s}-value`,ref:e=>this.inputRef=e,tabindex:"0",onBlur:this.onComboBlur.bind(this),onKeyDown:this.onComboKeyDown.bind(this)}),i("span",null,t&&((e=t[o])===null||e===void 0?void 0:e.label)?t[o].label:""),i("svg",{class:{arrow:true,open:r},xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"},i("path",{d:"m6 9 6 6 6-6"}))),i("go-dropdown",{disabled:c||h,"trigger-selector":`#${s}-value`,width:a,onOpened:()=>{this.updateMenuState(true)},onClosed:()=>{this.updateMenuState(false)},role:"listbox",ref:e=>this.listboxRef=e,id:`${s}-listbox`},t&&t.map(((e,t)=>i("div",{class:{current:this.activeIndex===t,"combo-option":true},id:`${s}-${t}`,"aria-selected":this.activeIndex===t?"true":undefined,ref:e=>{if(this.activeIndex===t){this.activeOptionRef=e}},role:"option",onClick:e=>{e.stopPropagation();this.onOptionClick(t)},onMouseDown:this.onOptionMouseDown.bind(this)},e.label))))))]}getSearchString(e){if(typeof this.searchTimeout==="number"){window.clearTimeout(this.searchTimeout)}this.searchTimeout=window.setTimeout((()=>{this.searchString=""}),500);this.searchString+=e;return this.searchString}onComboKeyDown(e){if(!this.parsedOptions){return}const{key:t}=e;const i=this.parsedOptions.length-1;const o=p(e,this.open);switch(o){case h.Next:case h.Last:case h.First:case h.Previous:e.preventDefault();return this.onOptionChange(m(this.activeIndex,i,o));case h.CloseSelect:case h.Space:e.preventDefault();this.selectOption(this.activeIndex);case h.Close:e.preventDefault();return this.updateMenuState(false);case h.Type:this.onComboType(t);case h.Open:e.preventDefault();return this.updateMenuState(true)}}onComboBlur(){if(this.ignoreBlur){this.ignoreBlur=false;return}if(this.open){this.selectOption(this.activeIndex);this.updateMenuState(false,false)}}onComboType(e){this.updateMenuState(true);const t=this.getSearchString(e);const i=g(this.parsedOptions,t,this.activeIndex+1);if(i>=0){this.onOptionChange(i)}}onOptionChange(e){this.activeIndex=e}onOptionClick(e){this.onOptionChange(e);this.selectOption(e);this.updateMenuState(false)}onOptionMouseDown(){this.ignoreBlur=true}selectOption(e){if(e<0){return}const t=this.parsedOptions[e];this.selectedLabel=t.label;this.selectedIndex=e;this.value=t.value;this.goChange.emit({value:t.value})}updateMenuState(e,t=true){if(e&&(this.readonly||this.disabled)){return}this.open=e;if(t){this.inputRef.focus()}}get el(){return o(this)}static get watchers(){return{options:["loadOptions"],value:["loadValue"],open:["handleDomOnOpen"]}}};y.style=x;export{y as go_select};
//# sourceMappingURL=p-40716f61.entry.js.map